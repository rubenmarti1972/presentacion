<svg
  [attr.width]="svgWidth"
  [attr.height]="svgHeight"
  class="color-triangle-svg"
  (click)="clearSelection()">

  <!-- Definición de gradiente para fondo -->
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#000000;stop-opacity:1" />
    </linearGradient>

    <!-- Marcador para flechas -->
    <marker id="arrowhead" markerWidth="8" markerHeight="8"
            refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="rgba(255, 255, 255, 0.4)" />
    </marker>

    <marker id="arrowheadHighlighted" markerWidth="8" markerHeight="8"
            refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#FFD700" />
    </marker>
  </defs>

  <!-- Fondo -->
  <rect width="100%" height="100%" fill="url(#bgGradient)" (click)="clearSelection()" />

  <!-- Conexiones (flechas) -->
  <g class="connections">
    <line
      *ngFor="let conn of connections"
      [attr.x1]="conn.from.cx"
      [attr.y1]="conn.from.cy"
      [attr.x2]="conn.to.cx"
      [attr.y2]="conn.to.cy"
      [attr.class]="getConnectionClass(conn)"
      [attr.marker-end]="isConnectionHighlighted(conn) ? 'url(#arrowheadHighlighted)' : 'url(#arrowhead)'"
      (click)="$event.stopPropagation()"
    />
  </g>

  <!-- Círculos de colores -->
  <g class="circles">
    <ng-container *ngFor="let row of circles">
      <circle
        *ngFor="let circle of row"
        [attr.cx]="circle.cx"
        [attr.cy]="circle.cy"
        [attr.r]="circleRadius"
        [attr.fill]="circle.color"
        [attr.class]="getCircleClass(circle)"
        (click)="onCircleClick(circle); $event.stopPropagation()"
        style="cursor: pointer;"
      />
    </ng-container>
  </g>

  <!-- Círculo blanco en la cima (arriba del todo) -->
  <circle
    [attr.cx]="svgWidth / 2"
    cy="90"
    [attr.r]="circleRadius + 5"
    fill="white"
    stroke="#ffffff"
    stroke-width="3"
    class="white-top-circle"
  />

  <!-- Etiquetas de texto -->
  <!-- SATURACIÓN: vertical a la izquierda -->
  <g transform="translate(30, 250) rotate(-90)">
    <text
      x="0"
      y="0"
      class="label-text"
      text-anchor="middle">
      ↑ SATURACIÓN ↓
    </text>
  </g>

  <!-- TONO: horizontal en la base de izquierda a derecha -->
  <text
    x="50"
    y="510"
    class="label-text"
    text-anchor="start">
    ← TONO →
  </text>

  <!-- Instrucciones -->
  <text
    [attr.x]="svgWidth / 2"
    y="540"
    class="label-text label-hint"
    text-anchor="middle">
    (Haz clic en DOS colores adyacentes para ver qué color forman)
  </text>
</svg>
